<!DOCTYPE html>
<html>
<head>
    <title>WhatsApp Integration - Installation Guide</title>
    <style>
        body { font-family: Arial; background: #f5f5f5; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
        h1 { color: #25D366; border-bottom: 3px solid #25D366; padding-bottom: 10px; }
        h2 { color: #1FAC63; margin-top: 30px; }
        .step { background: #f9f9f9; padding: 15px; margin: 15px 0; border-left: 4px solid #25D366; border-radius: 5px; }
        .code { background: #2d2d2d; color: #f8f8f2; padding: 15px; border-radius: 5px; overflow-x: auto; margin: 10px 0; font-family: monospace; }
        .success { color: #28a745; background: #d4edda; padding: 10px; border-radius: 5px; margin: 10px 0; }
        .warning { color: #856404; background: #fff3cd; padding: 10px; border-radius: 5px; margin: 10px 0; }
        .error { color: #721c24; background: #f8d7da; padding: 10px; border-radius: 5px; margin: 10px 0; }
        ul { line-height: 1.8; }
        strong { color: #1FAC63; }
    </style>
</head>
<body>
<div class="container">
    <h1>ğŸ”— WhatsApp Integration - Ù…Ú©Ù…Ù„ Ø³ÛŒÙ¹ Ø§Ù¾ Ú¯Ø§Ø¦ÛŒÚˆ</h1>

    <h2>Ù…Ø±Ø­Ù„Û 1: Node.js Ø§Ù†Ø³Ù¹Ø§Ù„ Ú©Ø±ÛŒÚº</h2>
    <div class="step">
        <p>Ø§Ú¯Ø± Node.js Ø§Ù†Ø³Ù¹Ø§Ù„ Ù†ÛÛŒÚº ÛÛ’ ØªÙˆ <strong>nodejs.org</strong> Ø³Û’ ÚˆØ§Ø¤Ù† Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº</p>
        <p>Ø§Ù†Ø³Ù¹Ø§Ù„ Ú©Ø±ÛŒÚº Ø§ÙˆØ± verify Ú©Ø±ÛŒÚº:</p>
        <div class="code">
node --version
npm --version
        </div>
    </div>

    <h2>Ù…Ø±Ø­Ù„Û 2: WhatsApp Server Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚº</h2>
    <div class="step">
        <p>PowerShell Ù…ÛŒÚº ÛŒÛ commands Ú†Ù„Ø§Ø¦ÛŒÚº:</p>
        <div class="code">
cd c:\xampp\htdocs\whatsapp-server
npm install
npm start
        </div>
        <div class="success">
            âœ… Ø§Ú¯Ø± server successfully Ø´Ø±ÙˆØ¹ ÛÙˆ Ú¯ÛŒØ§ ØªÙˆ ÛŒÛ message Ø¯ÛŒÚ©Ú¾ÛŒÚº:<br>
            ğŸš€ WhatsApp Server running on port 3001
        </div>
    </div>

    <h2>Ù…Ø±Ø­Ù„Û 3: Database Tables Ø¨Ù†Ø§Ø¦ÛŒÚº</h2>
    <div class="step">
        <p>phpMyAdmin Ú©Ú¾ÙˆÙ„ÛŒÚº Ø§ÙˆØ± ÛŒÛ SQL queries Ú†Ù„Ø§Ø¦ÛŒÚº:</p>
        <div class="code">
CREATE TABLE IF NOT EXISTS `whatsapp_config` (
    `id` INT PRIMARY KEY AUTO_INCREMENT,
    `whatsapp_enabled` BOOLEAN DEFAULT 1,
    `node_server_url` VARCHAR(255) NOT NULL DEFAULT 'http://localhost:3001',
    `message_on_register` BOOLEAN DEFAULT 1,
    `message_on_order` BOOLEAN DEFAULT 1,
    `register_message_template` LONGTEXT,
    `order_message_template` LONGTEXT,
    `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS `whatsapp_message_logs` (
    `id` INT PRIMARY KEY AUTO_INCREMENT,
    `phone` VARCHAR(20),
    `message_type` VARCHAR(50),
    `message_content` LONGTEXT,
    `user_id` INT,
    `order_id` INT,
    `status` VARCHAR(20) DEFAULT 'sent',
    `sent_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO whatsapp_config (register_message_template, order_message_template) 
VALUES (
    'Ø³Ù„Ø§Ù… {{name}}! ğŸ‘‹\n\nØ¢Ù¾ Ù†Û’ ÛÙ…Ø§Ø±ÛŒ Ø³Ø±ÙˆØ³ Ù…ÛŒÚº Ø´Ø§Ù…Ù„ ÛÙˆ Ú¯Ø¦Û’ ÛÛŒÚºÛ”\nØ§Ù¾Ù†Ø§ Ø§Ú©Ø§Ø¤Ù†Ù¹ Ø§Ø¨ Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Ø±ÛŒÚºÛ”\n\nØ´Ú©Ø±ÛŒÛ!',
    'Ø³Ù„Ø§Ù… {{name}}! ğŸ‰\n\nØ¢Ù¾ Ú©Ø§ Ø¢Ø±ÚˆØ± #{{order_id}} Ù…Ú©Ù…Ù„ ÛÙˆ Ú¯ÛŒØ§Û”\nØ³Ø±ÙˆØ³: {{service}}\nÙ‚ÛŒÙ…Øª: {{price}}\n\nÙ…Ø²ÛŒØ¯ Ù…Ø¯Ø¯ Ú©Û’ Ù„ÛŒÛ’ Ø±Ø§Ø¨Ø·Û Ú©Ø±ÛŒÚºÛ”'
);
        </div>
    </div>

    <h2>Ù…Ø±Ø­Ù„Û 4: Admin Panel Ù…ÛŒÚº Menu Add Ú©Ø±ÛŒÚº</h2>
    <div class="step">
        <p><strong>admin/views/header.php</strong> Ù…ÛŒÚº ÛŒÛ line add Ú©Ø±ÛŒÚº:</p>
        <div class="code">
&lt;li class="&lt;?php if (route(1) == 'whatsapp') : echo 'active' ; endif; ?&gt;"&gt;
    &lt;a class="ajax-link" href="&lt;?php echo site_url('admin/whatsapp') ?&gt;"&gt;
        &lt;i class="bi bi-chat-dots" style="color: #25D366;"&gt;&lt;/i&gt;
        &lt;span&gt; WhatsApp&lt;/span&gt;
    &lt;/a&gt;
&lt;/li&gt;
        </div>
        <p>ÛŒÛ menu item <strong>Additionals</strong> Ù…ÛŒÚº add Ú©Ø±ÛŒÚº</p>
    </div>

    <h2>Ù…Ø±Ø­Ù„Û 5: Routing Ø´Ø§Ù…Ù„ Ú©Ø±ÛŒÚº</h2>
    <div class="step">
        <p><strong>admin/index.php</strong> Ù…ÛŒÚº routing section Ù…ÛŒÚº ÛŒÛ add Ú©Ø±ÛŒÚº:</p>
        <div class="code">
// WhatsApp Routes
if (route(1) === 'whatsapp') {
    if (!route(2)) {
        include __DIR__ . '/views/whatsapp.php';
    } else {
        $_GET['action'] = 'whatsapp-' . route(2);
        include __DIR__ . '/controller/whatsapp-ajax.php';
    }
}
        </div>
    </div>

    <h2>Ù…Ø±Ø­Ù„Û 6: Auto Messages Ø´Ø§Ù…Ù„ Ú©Ø±ÛŒÚº</h2>
    <div class="step">
        <p><strong>User Registration Ú©Û’ Ø¨Ø¹Ø¯:</strong></p>
        <p>Ø¬ÛØ§Úº user register ÛÙˆØªØ§ ÛÛ’ (Ø´Ø§ÛŒØ¯ <strong>admin/controller/clients.php</strong> ÛŒØ§ similar Ù…ÛŒÚº):</p>
        <div class="code">
// User registration Ú©Û’ Ø¨Ø¹Ø¯
require_once __DIR__ . '/../../whatsapp-server/whatsapp-hooks.php';

$userPhone = $_POST['phone'] ?? null; // Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Ù†Ù†Ø¯Û Ú©Û’ phone
if ($userPhone) {
    sendWhatsAppRegisterMessage(
        $newUserId,
        $userName,
        $userPhone,
        $userEmail
    );
}
        </div>
        <p><strong>Order Place Ú©Û’ Ø¨Ø¹Ø¯:</strong></p>
        <div class="code">
// Order place Ú©Û’ Ø¨Ø¹Ø¯
require_once __DIR__ . '/../../whatsapp-server/whatsapp-hooks.php';

sendWhatsAppOrderMessage(
    $orderId,
    $userId,
    $userName,
    $userPhone,
    $serviceName,
    $quantity,
    $price
);
        </div>
    </div>

    <h2>Ù…Ø±Ø­Ù„Û 7: QR Code Ø³Û’ WhatsApp Ø¬ÙˆÚ‘ÛŒÚº</h2>
    <div class="step">
        <p>1. Admin Panel Ù…ÛŒÚº <strong>WhatsApp</strong> menu Ù¾Ø± Ø¬Ø§Ø¦ÛŒÚº</p>
        <p>2. QR Code Ú©Ùˆ Ø¯ÛŒÚ©Ú¾ÛŒÚº</p>
        <p>3. Ø§Ù¾Ù†Û’ ÙÙˆÙ† Ù…ÛŒÚº WhatsApp Ú©Ú¾ÙˆÙ„ÛŒÚº â†’ Settings â†’ Linked Devices â†’ Link a Device</p>
        <p>4. QR Code Ú©Ùˆ scan Ú©Ø±ÛŒÚº</p>
        <div class="success">
            âœ… Ø¬Ø¨ connection ÛÙˆ Ø¬Ø§Ø¦Û’ ØªÙˆ status "Connected" Ø¯Ú©Ú¾Û’ Ú¯ÛŒ
        </div>
    </div>

    <h2>Ù…Ø±Ø­Ù„Û 8: Test Ú©Ø±ÛŒÚº</h2>
    <div class="step">
        <p>Admin Panel Ù…ÛŒÚº:</p>
        <ol>
            <li>WhatsApp section Ù…ÛŒÚº Ø¬Ø§Ø¦ÛŒÚº</li>
            <li>"Send Test Message" Ù…ÛŒÚº phone number ÚˆØ§Ù„ÛŒÚº</li>
            <li>Send button Ø¯Ø¨Ø§Ø¦ÛŒÚº</li>
            <li>Ø§Ù¾Ù†Û’ WhatsApp Ù¾Ø± message Ø¢Ø¦Û’ Ú¯Ø§</li>
        </ol>
        <div class="success">
            âœ… Ø§Ú¯Ø± message Ø¢ Ú¯ÛŒØ§ ØªÙˆ Ø³Ø¨ Ú©Ú†Ú¾ ØµØ­ÛŒØ­ ÛÛ’!
        </div>
    </div>

    <h2>Ù…Ø±Ø­Ù„Û 9: Settings Configure Ú©Ø±ÛŒÚº</h2>
    <div class="step">
        <p>Admin Panel Ù…ÛŒÚº:</p>
        <ol>
            <li>Toggle enable Ú©Ø±ÛŒÚº "Send on User Register"</li>
            <li>Toggle enable Ú©Ø±ÛŒÚº "Send on Order Place"</li>
            <li>Message templates customise Ú©Ø±ÛŒÚº</li>
            <li>"Save Settings" Ø¯Ø¨Ø§Ø¦ÛŒÚº</li>
        </ol>
    </div>

    <h2>ğŸ”§ Troubleshooting</h2>
    <div class="warning">
        <strong>Ù…Ø³Ø¦Ù„Û:</strong> WhatsApp server Ù†ÛÛŒÚº Ø¬Ú‘ Ø±ÛØ§<br>
        <strong>Ø­Ù„:</strong> ÛŒÙ‚ÛŒÙ†ÛŒ Ø¨Ù†Ø§Ø¦ÛŒÚº Ú©Û Node.js server Ú†Ù„ Ø±ÛØ§ ÛÛ’ Ø§ÙˆØ± port 3001 open ÛÛ’
    </div>
    <div class="warning">
        <strong>Ù…Ø³Ø¦Ù„Û:</strong> QR Code Ù†ÛÛŒÚº Ø¢ Ø±ÛØ§<br>
        <strong>Ø­Ù„:</strong> Server logs Ú†ÛŒÚ© Ú©Ø±ÛŒÚº, Ø´Ø§ÛŒØ¯ WhatsApp Ú©Ùˆ Ù¾ÛÙ„Û’ Ø³Û’ authorize Ú©ÛŒ Ø¶Ø±ÙˆØ±Øª ÛÛ’
    </div>
    <div class="warning">
        <strong>Ù…Ø³Ø¦Ù„Û:</strong> Messages Ù†ÛÛŒÚº Ø¨Ú¾ÛŒØ¬ Ø±ÛÛ’<br>
        <strong>Ø­Ù„:</strong> WhatsApp connection status check Ú©Ø±ÛŒÚº, database Ù…ÛŒÚº config ÛÛ’ ÛŒØ§ Ù†ÛÛŒÚº
    </div>

    <h2>ğŸ“± Variables Reference</h2>
    <div class="step">
        <p><strong>Registration Message Ù…ÛŒÚº:</strong></p>
        <ul>
            <li>{{name}} - User Ú©Ø§ Ù†Ø§Ù…</li>
            <li>{{username}} - Username</li>
            <li>{{email}} - Email address</li>
            <li>{{registration_date}} - Registration Ú©ÛŒ ØªØ§Ø±ÛŒØ®</li>
        </ul>
        <p><strong>Order Message Ù…ÛŒÚº:</strong></p>
        <ul>
            <li>{{name}} - User Ú©Ø§ Ù†Ø§Ù…</li>
            <li>{{service}} - Service Ú©Ø§ Ù†Ø§Ù…</li>
            <li>{{quantity}} - Ù…Ù‚Ø¯Ø§Ø±</li>
            <li>{{price}} - Ù‚ÛŒÙ…Øª</li>
            <li>{{order_id}} - Order ID</li>
        </ul>
    </div>

    <h2>ğŸ¯ Ø¨ÛØªØ±ÛŒÙ† Ø·Ø±ÛŒÙ‚Û’</h2>
    <div class="step">
        <ul>
            <li>ÛÙ…ÛŒØ´Û test Ú©Ø±ÛŒÚº Ù¾ÛÙ„Û’ production Ù…ÛŒÚº Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Ø±Ù†Û’ Ø³Û’</li>
            <li>Message templates Ú©Ùˆ Ø§Ø±Ø¯Ùˆ Ù…ÛŒÚº Ù„Ú©Ú¾ÛŒÚº ØªØ§Ú©Û Ø¨ÛØªØ± response Ù…Ù„Û’</li>
            <li>Phone numbers Ú©Ùˆ ØµØ­ÛŒØ­ format Ù…ÛŒÚº Ø±Ú©Ú¾ÛŒÚº (92XXXXXXXXXX)</li>
            <li>Server logs regular Ú†ÛŒÚ© Ú©Ø±ÛŒÚº errors Ú©Û’ Ù„ÛŒÛ’</li>
            <li>WhatsApp connected Ø±ÛØªØ§ ÛÛ’ ØªØ§Ú©Û messages Ø¨Ú¾ÛŒØ¬ Ø³Ú©ÛŒÚº</li>
        </ul>
    </div>

    <h2>âœ… Ø§Ø¨ Ù…Ú©Ù…Ù„ ÛÙˆ Ú¯ÛŒØ§!</h2>
    <div class="success">
        Ø¢Ù¾ Ú©Ø§ WhatsApp integration Ù…Ú©Ù…Ù„ Ø·ÙˆØ± Ù¾Ø± Ø³ÛŒÙ¹ ÛÙˆ Ú¯ÛŒØ§ ÛÛ’!
        Ø§Ø¨ Ø¬Ø¨ Ú©ÙˆØ¦ÛŒ user register Ú©Ø±Û’ ÛŒØ§ order place Ú©Ø±Û’ ØªÙˆ ÙˆÛ WhatsApp Ù¾Ø± message Ù¾Ø§Ø¦ÛŒÚº Ú¯Û’Û”
    </div>

</div>
</body>
</html>
